<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <title>KoELECTRA Articles Table</title>
    <!-- <style>
        thead input, thead select {
          width: 100%;
          box-sizing: border-box;
          height: 32px;
          padding: 4px 8px;
          border: 1px solid #ddd;
          border-radius: 4px;
        }
        th.date-filter { min-width: 250px; white-space: nowrap; }
        .date-range-group { display: flex; gap: 6px; }
        .date-range-group input {
          width: 120px; min-width: 100px; max-width: 130px; display: inline-block; margin: 0;
        }
        #toggle-filter-btn { padding: 3px 8px; font-size: 0.875rem; }
    </style> -->

    {% set active_tab = 'koelectra' %}
    {% include 'header.html' %}
</head>
<body id="page-top">

<div class="container-fluid mt-4">

    <div class="card shadow mb-4">
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-bordered" id="koelectraTable" width="100%" cellspacing="0">
                    <thead class="thead-dark">
                        <tr>
                            <th>id</th>
                            <th>keyword_id</th>
                            <th>keyword</th>
                            <th>title</th>
                            <th>content</th>
                            <th>url</th>
                            <th>sentiment</th>
                            <th>score</th>
                            <th>published_at</th>
                            <th>collected_at</th>
                        </tr>
                        <!-- ÌïÑÌÑ∞ ÏûÖÎ†•Ìñâ: Í∏∞Î≥∏ Ïà®ÍπÄ, ÌÜ†Í∏ÄÎ°ú Î≥¥ÏûÑ/Ïà®ÍπÄ -->
                        <tr id="filter-row" style="display:none;">
                            <th><input type="text" placeholder="Í≤ÄÏÉâ id" /></th>
                            <th><input type="text" placeholder="Í≤ÄÏÉâ keyword_id" /></th>
                            <th><input type="text" placeholder="Í≤ÄÏÉâ keyword" /></th>
                            <th><input type="text" placeholder="Í≤ÄÏÉâ title" /></th>
                            <th><input type="text" placeholder="Í≤ÄÏÉâ content" /></th>
                            <th><input type="text" placeholder="Í≤ÄÏÉâ url" /></th>
                            <th>
                                <select>
                                    <option value="">Ï†ÑÏ≤¥</option>
                                    {% set sentiments = ['angry', 'happy', 'anxious', 'embarrassed', 'sad', 'heartache'] %}
                                    {% for s in sentiments %}
                                    <option value="{{ s }}">{{ s|capitalize }}</option>
                                    {% endfor %}
                                </select>
                            </th>
                            <th><input type="text" placeholder="Í≤ÄÏÉâ score" /></th>
                            <th class="date-filter">
                                <div class="date-range-group">
                                    <input type="text" id="published_at_min" placeholder="ÏãúÏûëÏùº (YYYY-MM-DD)" autocomplete="off" />
                                    <input type="text" id="published_at_max" placeholder="Ï¢ÖÎ£åÏùº (YYYY-MM-DD)" autocomplete="off" />
                                </div>
                            </th>
                            <th class="date-filter">
                                <div class="date-range-group">
                                    <input type="text" id="collected_at_min" placeholder="ÏãúÏûëÏùº (YYYY-MM-DD)" autocomplete="off" />
                                    <input type="text" id="collected_at_max" placeholder="Ï¢ÖÎ£åÏùº (YYYY-MM-DD)" autocomplete="off" />
                                </div>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for row in data %}
                        <tr>
                            {% for value in row %}
                                {% set idx = loop.index0 %}
                                {% if idx == 5 %}
                                    <td><a href="{{ value }}" target="_blank" rel="noopener noreferrer">Í∏∞ÏÇ¨ÎßÅÌÅ¨</a></td>
                                {% elif idx == 6 %}
                                    <td>
                                        {% set emoji_map = {
                                            'angry': 'üò†',
                                            'happy': 'üòä',
                                            'anxious': 'üò∞',
                                            'embarrassed': 'üò≥',
                                            'sad': 'üò¢',
                                            'heartache': 'üíî'
                                        } %}
                                        {{ emoji_map.get(value|lower, '‚ùì') }} {{ value }}
                                    </td>
                                {% elif idx == 7 %}
                                    <td style="min-width: 120px;">
                                        <div>{{ "%.3f"|format(value) }}</div>
                                        <div class="progress">
                                            <div class="progress-bar" role="progressbar"
                                                 style="width: {{ (value * 100)|round(2) }}%;"
                                                 aria-valuenow="{{ (value * 100)|round(2) }}"
                                                 aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </td>
                                {% else %}
                                    <td>{{ value }}</td>
                                {% endif %}
                            {% endfor %}
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

{% include 'footer.html' %}
{% include 'scripts/table-filter-common.html' %}
<script>    
    $(document).ready(function() {
        var $table = $('#koelectraTable');
        var $publishedAtIndex = 8;
        var $collectedAtIndex = 9;
        initializeTableFilter($table, $publishedAtIndex, $collectedAtIndex);
    });
</script>

</body>
</html>

